{"version":3,"file":"bundle.js","sources":["../src/toc.ts","../src/math-copy.ts","../src/copy-page.ts","../src/main.ts"],"sourcesContent":["/**\n * Table of Contents Component\n * Generates floating TOC with active section highlighting\n */\n\ninterface TocItem {\n  id: string;\n  text: string;\n  level: number;\n  element: HTMLHeadingElement;\n}\n\nclass TOCManager {\n  private tocContainer: HTMLElement | null = null;\n  private tocItems: TocItem[] = [];\n  private activeId: string | null = null;\n\n  init(): void {\n    // Find TOC container (if present)\n    this.tocContainer = document.getElementById('toc');\n    if (!this.tocContainer) return;\n\n    // Check if TOC already exists (rendered by backend)\n    const existingToc = this.tocContainer.querySelector('.toc-nav');\n    if (existingToc) {\n      // TOC already rendered by backend, just set up scroll spy\n      this.extractHeadingsFromExistingTOC();\n      this.setupScrollSpy();\n      return;\n    }\n\n    // Extract headings from content\n    this.extractHeadings();\n\n    if (this.tocItems.length === 0) {\n      this.tocContainer.style.display = 'none';\n      return;\n    }\n\n    // Render TOC\n    this.renderTOC();\n\n    // Set up scroll spy\n    this.setupScrollSpy();\n  }\n\n  private extractHeadings(): void {\n    const content = document.querySelector('article, main, .content');\n    if (!content) return;\n\n    const headings = content.querySelectorAll('h2, h3, h4');\n    headings.forEach((heading) => {\n      const h = heading as HTMLHeadingElement;\n      const level = parseInt(h.tagName.substring(1));\n\n      // Ensure heading has an ID\n      if (!h.id) {\n        h.id = this.slugify(h.textContent || '');\n      }\n\n      this.tocItems.push({\n        id: h.id,\n        text: h.textContent || '',\n        level: level,\n        element: h,\n      });\n    });\n  }\n\n  private extractHeadingsFromExistingTOC(): void {\n    if (!this.tocContainer) return;\n\n    const links = this.tocContainer.querySelectorAll('.toc-list a');\n    links.forEach((link) => {\n      const href = link.getAttribute('href');\n      if (!href || !href.startsWith('#')) return;\n\n      const id = href.substring(1);\n      const heading = document.getElementById(id) as HTMLHeadingElement;\n      if (!heading) return;\n\n      const level = parseInt(heading.tagName.substring(1));\n\n      // Find or create the parent li element\n      const li = link.closest('li');\n      if (li) {\n        li.dataset.id = id;\n      }\n\n      this.tocItems.push({\n        id: id,\n        text: link.textContent || '',\n        level: level,\n        element: heading,\n      });\n    });\n  }\n\n  private renderTOC(): void {\n    if (!this.tocContainer) return;\n\n    const nav = document.createElement('nav');\n    nav.className = 'toc-nav';\n\n    const title = document.createElement('h3');\n    title.textContent = 'Contents';\n    nav.appendChild(title);\n\n    const list = document.createElement('ul');\n    list.className = 'toc-list';\n\n    this.tocItems.forEach(item => {\n      const li = document.createElement('li');\n      li.className = `toc-level-${item.level}`;\n      li.dataset.id = item.id;\n\n      const link = document.createElement('a');\n      link.href = `#${item.id}`;\n      link.textContent = item.text;\n      link.addEventListener('click', (e) => {\n        e.preventDefault();\n        this.scrollToHeading(item.id);\n      });\n\n      li.appendChild(link);\n      list.appendChild(li);\n    });\n\n    nav.appendChild(list);\n    this.tocContainer.appendChild(nav);\n  }\n\n  private setupScrollSpy(): void {\n    // Intersection Observer for active section highlighting\n    const options = {\n      rootMargin: '-100px 0px -66%',\n      threshold: 1.0,\n    };\n\n    const observer = new IntersectionObserver((entries) => {\n      entries.forEach(entry => {\n        if (entry.isIntersecting) {\n          const id = entry.target.id;\n          this.setActive(id);\n        }\n      });\n    }, options);\n\n    this.tocItems.forEach(item => {\n      observer.observe(item.element);\n    });\n  }\n\n  private setActive(id: string): void {\n    if (this.activeId === id) return;\n\n    // Remove previous active\n    if (this.activeId) {\n      const prevItem = this.tocContainer?.querySelector(`[data-id=\"${this.activeId}\"]`);\n      prevItem?.classList.remove('active');\n    }\n\n    // Set new active\n    this.activeId = id;\n    const newItem = this.tocContainer?.querySelector(`[data-id=\"${id}\"]`);\n    newItem?.classList.add('active');\n  }\n\n  private scrollToHeading(id: string): void {\n    const heading = document.getElementById(id);\n    if (!heading) return;\n\n    heading.scrollIntoView({ behavior: 'smooth', block: 'start' });\n    window.history.pushState(null, '', `#${id}`);\n  }\n\n  private slugify(text: string): string {\n    return text\n      .toLowerCase()\n      .replace(/[^\\w\\s-]/g, '')\n      .replace(/\\s+/g, '-')\n      .replace(/-+/g, '-')\n      .trim();\n  }\n}\n\n// Singleton instance\nlet tocManager: TOCManager | null = null;\n\nexport function initTOC(): void {\n  if (!tocManager) {\n    tocManager = new TOCManager();\n    tocManager.init();\n  }\n}\n\nexport type { TocItem };\n","/**\n * Make Typst math SVGs copyable by copying the original math source\n */\n\nexport function initMathCopy() {\n  const mathNodes = new Set<HTMLElement>();\n\n  const attach = (mathEl: Element) => {\n    if (!(mathEl instanceof HTMLElement) || mathNodes.has(mathEl)) return;\n    mathNodes.add(mathEl);\n\n    mathEl.style.userSelect = 'text';\n    mathEl.style.cursor = 'text';\n\n    const handleCopy = (e: ClipboardEvent) => {\n      const mathSource = mathEl.getAttribute('data-math') || '';\n      if (!mathSource || !selectionIntersects(mathEl)) return;\n\n      e.preventDefault();\n      copyText(mathSource).then();\n    };\n\n    mathEl.addEventListener('copy', handleCopy);\n  };\n\n  document.querySelectorAll('.typst-math').forEach(attach);\n\n  const observer = new MutationObserver((mutations) => {\n    for (const mutation of mutations) {\n      mutation.addedNodes.forEach((node) => {\n        if (!(node instanceof Element)) return;\n        if (node.classList?.contains('typst-math')) {\n          attach(node);\n        }\n        node.querySelectorAll?.('.typst-math').forEach(attach);\n      });\n    }\n  });\n\n  observer.observe(document.body, { childList: true, subtree: true });\n\n  document.addEventListener('selectionchange', () => {\n    const sel = window.getSelection();\n    mathNodes.forEach((el) => {\n      if (sel && !sel.isCollapsed && selectionIntersects(el)) {\n        el.classList.add('selecting');\n      } else {\n        el.classList.remove('selecting');\n      }\n    });\n  });\n}\n\nasync function copyText(text: string): Promise<boolean> {\n  try {\n    if (navigator.clipboard?.writeText) {\n      await navigator.clipboard.writeText(text);\n      return true;\n    }\n  } catch (err) {\n    console.warn('Navigator clipboard copy failed, falling back', err);\n  }\n\n  const textarea = document.createElement('textarea');\n  textarea.value = text;\n  textarea.setAttribute('readonly', '');\n  textarea.style.position = 'absolute';\n  textarea.style.left = '-9999px';\n  document.body.appendChild(textarea);\n  textarea.select();\n\n  let success = false;\n  try {\n    success = document.execCommand('copy');\n  } catch (err) {\n    console.warn('Fallback copy failed', err);\n  } finally {\n    document.body.removeChild(textarea);\n  }\n\n  return success;\n}\n\nfunction selectionIntersects(el: HTMLElement): boolean {\n  const sel = window.getSelection();\n  if (!sel || sel.rangeCount === 0) return false;\n  try {\n    const range = sel.getRangeAt(0);\n    return range.intersectsNode(el);\n  } catch {\n    return false;\n  }\n}\n","/**\n * Copy the current page's raw markdown source.\n */\n\nexport function initCopyPageSource() {\n  const button = document.getElementById('copy-page-source');\n  const source = readSourcePayload();\n\n  if (!(button instanceof HTMLButtonElement)) return;\n\n  const defaultLabel = button.textContent || 'Copy page source';\n\n  if (!source) {\n    button.disabled = true;\n    button.title = 'Source unavailable';\n    return;\n  }\n\n  button.addEventListener('click', async () => {\n    const success = await copyText(source);\n    showStatus(button, success ? 'Copied!' : 'Copy failed', defaultLabel);\n  });\n}\n\nfunction readSourcePayload(): string | null {\n  const el = document.getElementById('page-source-data');\n  if (!el) return null;\n  try {\n    const raw = el.textContent || '';\n    return JSON.parse(raw);\n  } catch (err) {\n    console.warn('Failed to parse page source payload', err);\n    return null;\n  }\n}\n\nasync function copyText(text: string): Promise<boolean> {\n  try {\n    if (navigator.clipboard?.writeText) {\n      await navigator.clipboard.writeText(text);\n      return true;\n    }\n  } catch (err) {\n    console.warn('Navigator clipboard copy failed, falling back', err);\n  }\n\n  const textarea = document.createElement('textarea');\n  textarea.value = text;\n  textarea.setAttribute('readonly', '');\n  textarea.style.position = 'absolute';\n  textarea.style.left = '-9999px';\n  document.body.appendChild(textarea);\n  textarea.select();\n\n  let success = false;\n  try {\n    success = document.execCommand('copy');\n  } catch (err) {\n    console.warn('Fallback copy failed', err);\n  } finally {\n    document.body.removeChild(textarea);\n  }\n\n  return success;\n}\n\nfunction showStatus(button: HTMLButtonElement, status: string, defaultLabel: string) {\n  const prev = button.textContent;\n  button.textContent = status;\n  button.dataset.state = status.toLowerCase().includes('copied') ? 'copied' : 'error';\n\n  setTimeout(() => {\n    button.textContent = prev || defaultLabel;\n    button.dataset.state = '';\n  }, 1200);\n}\n","/**\n * Monowiki Theme\n *\n * Main entry point for all frontend components\n */\n\nimport { initTOC } from './toc';\nimport { initMathCopy } from './math-copy';\nimport { initCopyPageSource } from './copy-page';\n// import { initDarkMode } from './darkmode';\n\n// Initialize all components when DOM is ready\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', init);\n} else {\n  init();\n}\n\nfunction init() {\n  setupPreviewsLoader();\n  setupSearchLoader();\n  setupGraphLoader();\n  initTOC();\n  initMathCopy();\n  initCopyPageSource();\n  // initDarkMode(); // Disabled for now\n}\n\nfunction setupPreviewsLoader() {\n  let loaded = false;\n  const load = async () => {\n    if (loaded) return;\n    loaded = true;\n    try {\n      const { initPreviews } = await import('./previews');\n      initPreviews();\n    } catch (err) {\n      console.error('Failed to load previews', err);\n    } finally {\n      document.removeEventListener('pointerover', onPointerOver, true);\n    }\n  };\n\n  const onPointerOver = (event: Event) => {\n    const target = event.target;\n    if (target instanceof HTMLAnchorElement) {\n      const href = target.getAttribute('href') || '';\n      if (href.endsWith('.html')) {\n        load();\n      }\n    }\n  };\n\n  document.addEventListener('pointerover', onPointerOver, true);\n}\n\nfunction setupSearchLoader() {\n  const trigger = document.getElementById('search-trigger');\n  const modal = document.getElementById('search-modal');\n  if (!modal) return;\n\n  let loaded = false;\n  let loadingPromise: Promise<void> | null = null;\n\n  const loadSearch = async (openAfterLoad: boolean) => {\n    if (!loadingPromise) {\n      loadingPromise = (async () => {\n        try {\n          const { initSearch } = await import('./search');\n          await initSearch();\n          loaded = true;\n        } catch (err) {\n          console.error('Failed to load search', err);\n        }\n      })();\n    }\n\n    await loadingPromise;\n\n    if (loaded && openAfterLoad) {\n      const { openSearchModal } = await import('./search');\n      openSearchModal();\n    }\n  };\n\n  trigger?.addEventListener('click', () => {\n    void loadSearch(true);\n  });\n\n  document.addEventListener('keydown', (e) => {\n    if ((e.metaKey || e.ctrlKey) && e.key === 'k') {\n      e.preventDefault();\n      void loadSearch(true);\n    }\n  });\n}\n\nfunction setupGraphLoader() {\n  const localGraph = document.getElementById('graph-container');\n  const globalToggle = document.getElementById('global-graph-toggle');\n\n  if (!localGraph && !globalToggle) {\n    return;\n  }\n\n  let loaded = false;\n  let loadingPromise: Promise<void> | null = null;\n\n  const loadGraph = async (openAfterLoad: boolean) => {\n    if (!loadingPromise) {\n      loadingPromise = (async () => {\n        try {\n          const { initGraph } = await import('./graph');\n          await initGraph();\n          loaded = true;\n        } catch (err) {\n          console.error('Failed to load graph', err);\n        }\n      })();\n    }\n\n    await loadingPromise;\n\n    if (loaded && openAfterLoad) {\n      const { openGlobalGraph } = await import('./graph');\n      await openGlobalGraph();\n    }\n  };\n\n  // Load when user asks for global graph\n  globalToggle?.addEventListener('click', () => {\n    void loadGraph(true);\n  });\n\n  // Load when local graph enters viewport (or after idle fallback)\n  if (localGraph) {\n    const observer = new IntersectionObserver(\n      (entries) => {\n        if (entries.some((entry) => entry.isIntersecting)) {\n          observer.disconnect();\n          void loadGraph(false);\n        }\n      },\n      { rootMargin: '200px' },\n    );\n    observer.observe(localGraph);\n\n    // Fallback to idle load so graph is ready even if not scrolled\n    if ('requestIdleCallback' in window) {\n      (window as any).requestIdleCallback(() => void loadGraph(false));\n    } else {\n      setTimeout(() => void loadGraph(false), 1500);\n    }\n  }\n}\n"],"names":["copyText"],"mappings":"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"}